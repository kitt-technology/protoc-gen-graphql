syntax = "proto3";

package books;

import "github.com/kitt-technology/protoc-gen-graphql/graphql/graphql.proto";
import "google/protobuf/wrappers.proto";
import "google/protobuf/timestamp.proto";

option go_package = "example/books;books";

service Books {
  option (graphql.host) =
  "localhost:50051";

  rpc getBooks(GetBooksRequest) returns (GetBooksResponse) {}

  rpc getBooksByAuthor(graphql.BatchRequest) returns (GetBooksByAuthorResponse) {}
}

message GetBooksRequest {
  repeated string ids = 1;
  google.protobuf.BoolValue hardback_only = 2;
  google.protobuf.FloatValue price = 3;
  repeated Genre genres = 4;
  google.protobuf.Timestamp released_after = 5;
}

message GetBooksResponse {
  repeated Book books = 1;
}

message GetBooksByAuthorResponse {
  map<string, BooksByAuthor> results = 1;
}

message BooksByAuthor {
  repeated Book results = 2;

}
message Book {
  string id = 1;
  string name = 2;
  string author_id = 3;
  Genre genre = 4;
  google.protobuf.Timestamp release_date = 5;
}

enum Genre {
  Fiction = 0;
  Biography = 1;
}
